

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Step 2: Deployment &mdash; Doctr Versions Menu 0.2.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/doctr-versions-menu.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/mycss.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Folder Specifications" href="folderspecs.html" />
    <link rel="prev" title="Step 1: Sphinx extension" href="sphinx_extension.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Doctr Versions Menu
          

          
          </a>

          
            
            
              <div class="version">
                0.2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Doctr Versions Menu</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="sphinx_extension.html">Step 1: Sphinx extension</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Step 2: Deployment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#doctr-versions-menu"><code class="docutils literal notranslate"><span class="pre">doctr-versions-menu</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#debugging">Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#default-assumptions">Default assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#download-links">Download links</a></li>
<li class="toctree-l2"><a class="reference internal" href="#customization">Customization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#doctr-versions-menu-conf-configuration-file"><code class="docutils literal notranslate"><span class="pre">doctr-versions-menu.conf</span></code> configuration file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-line-options">Command line options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#doctr-versions-menu">doctr-versions-menu</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#folders-included-in-the-menu">Folders included in the menu</a></li>
<li class="toctree-l3"><a class="reference internal" href="#labels-in-the-versions-menu">Labels in the versions menu</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-warning-messages">Custom warning messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#customizing-index-html">Customizing <code class="docutils literal notranslate"><span class="pre">index.html</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#maintenance-on-gh-pages">Maintenance on <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="folderspecs.html">Folder Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="versions_json.html"><code class="docutils literal notranslate"><span class="pre">versions.json</span></code> Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="artifacts.html">Documentation Artifacts</a></li>
<li class="toctree-l1"><a class="reference internal" href="related_software.html">Related software</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Doctr Versions Menu</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Step 2: Deployment</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="step-2-deployment">
<h1>Step 2: Deployment<a class="headerlink" href="#step-2-deployment" title="Permalink to this headline">¶</a></h1>
<div class="section" id="doctr-versions-menu">
<span id="doctr-versions-menu-cli"></span><h2><code class="docutils literal notranslate"><span class="pre">doctr-versions-menu</span></code><a class="headerlink" href="#doctr-versions-menu" title="Permalink to this headline">¶</a></h2>
<p>The Doctr Versions Menu package includes a <code class="docutils literal notranslate"><span class="pre">doctr-versions-menu</span></code>
executable. This executable should be invoked when deploying the documentation
on <a class="reference external" href="https://travis-ci.org">Travis</a>, through <a class="reference external" href="https://drdoctr.github.io/commandline.html#cmdoption-doctr-deploy-command"><code class="docutils literal notranslate"><span class="pre">doctr</span> <span class="pre">deploy</span></code>’s <code class="docutils literal notranslate"><span class="pre">--command</span></code> flag</a>.</p>
<p>As the explicit purpose of the Doctr Versions Menu is to enable documentation
for multiple versions of a package at the same time, you’ll likely want to
invoke <code class="docutils literal notranslate"><span class="pre">doctr</span> <span class="pre">deploy</span></code> also with the <a class="reference external" href="https://drdoctr.github.io/commandline.html#cmdoption-doctr-deploy-no-require-master"><code class="docutils literal notranslate"><span class="pre">--no-required-master</span></code></a> and
<a class="reference external" href="https://drdoctr.github.io/commandline.html#cmdoption-doctr-deploy-build-tags"><code class="docutils literal notranslate"><span class="pre">--build-tags</span></code></a> options.</p>
<p>For example, your <code class="docutils literal notranslate"><span class="pre">.travis.yml</span></code> file might include the following
for deploying previously built documentation:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="o">[</span> ! -z <span class="s2">&quot;</span><span class="nv">$TRAVIS_TAG</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="nv">DEPLOY_DIR</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$TRAVIS_TAG</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">else</span> <span class="nv">DEPLOY_DIR</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$TRAVIS_BRANCH</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">fi</span>

doctr deploy --command<span class="o">=</span>doctr-versions-menu --no-require-master --build-tags <span class="s2">&quot;</span><span class="nv">$DEPLOY_DIR</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>See the deploy-section of the Doctr Versions Menu’s <a class="reference external" href="https://github.com/goerz/doctr_versions_menu/blob/master/.travis/doctr_build.sh"><code class="docutils literal notranslate"><span class="pre">doctr_build.sh</span></code> script</a>
(which is sourced from <a class="reference external" href="https://github.com/goerz/doctr_versions_menu/blob/master/.travis.yml"><code class="docutils literal notranslate"><span class="pre">.travis.yml</span></code></a>) for a more detailed example.</p>
<p>The main purpose of the <code class="docutils literal notranslate"><span class="pre">doctr-versions-menu</span></code> command is to generate the
<code class="docutils literal notranslate"><span class="pre">versions.json</span></code> file that the <a class="reference internal" href="sphinx_extension.html#sphinx-extension"><span class="std std-ref">Sphinx extension</span></a>
relies on, in the root of the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch.</p>
</div>
<div class="section" id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h2>
<p>If the <code class="docutils literal notranslate"><span class="pre">doctr-versions-menu</span></code> command behaves unexpectedly, add the <code class="docutils literal notranslate"><span class="pre">--debug</span></code> flag as follows:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>doctr deploy --command<span class="o">=</span><span class="s2">&quot;doctr-versions-menu --debug&quot;</span> --no-require-master --build-tags <span class="s2">&quot;</span><span class="nv">$DEPLOY_DIR</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Make sure to include the debug output when reporting bugs.</p>
</div>
<div class="section" id="default-assumptions">
<h2>Default assumptions<a class="headerlink" href="#default-assumptions" title="Permalink to this headline">¶</a></h2>
<p>You should not have to customize <code class="docutils literal notranslate"><span class="pre">doctr-versions-menu</span></code> provided you stick to the following sensible assumptions:</p>
<ul class="simple">
<li><p>Releases should be tagged as e.g. <code class="docutils literal notranslate"><span class="pre">v0.1.0</span></code> and deployed to a folder of the
same name. That is, a lower case letter <code class="docutils literal notranslate"><span class="pre">v</span></code> followed by a <span class="target" id="index-0"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0440"><strong>PEP 440</strong></a>-compatible
version identifier.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">master</span></code> branch should be deployed to a folder <code class="docutils literal notranslate"><span class="pre">master</span></code>.</p></li>
<li><p>Any other branch for which documentation is to be deployed should go in a folder matching the branch name.</p></li>
</ul>
<p>By default, the <code class="docutils literal notranslate"><span class="pre">index.html</span></code> file will forward to the documentation of the
latest public release (excluding pre-releases such as <code class="docutils literal notranslate"><span class="pre">v1.0.0-rc1</span></code>), or to
<code class="docutils literal notranslate"><span class="pre">master</span></code> if there have been no public releases. There is no support for an RTD-style
“latest”/”stable” folder. This is by design: deep-linking to “latest” documentation
is a bad practice, as such links easily become invalid when a new version is
released.</p>
</div>
<div class="section" id="download-links">
<span id="id1"></span><h2>Download links<a class="headerlink" href="#download-links" title="Permalink to this headline">¶</a></h2>
<p>By default, <code class="docutils literal notranslate"><span class="pre">doctr-versions-menu</span></code> looks for a file <code class="docutils literal notranslate"><span class="pre">_downloads</span></code> inside each
folder on the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch. Each line in this file should have the
markdown-like format <code class="docutils literal notranslate"><span class="pre">[label]:</span> <span class="pre">url</span></code>, e.g.</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>[<span class="nl">html</span>]: <span class="na">https://dl.bintray.com/goerz/doctr_versions_menu/doctr_versions_menu-v0.1.0.zip</span>
</pre></div>
</div>
<p>These links will be shown in the versions menu in a section “Downloads”, using
the label as the link text. See <a class="reference internal" href="artifacts.html#doc-artifacts"><span class="std std-ref">Documentation Artifacts</span></a> for further
information on how to build and upload the underlying files.</p>
</div>
<div class="section" id="customization">
<h2>Customization<a class="headerlink" href="#customization" title="Permalink to this headline">¶</a></h2>
<div class="section" id="doctr-versions-menu-conf-configuration-file">
<span id="doctr-versions-menu-conf"></span><h3><code class="docutils literal notranslate"><span class="pre">doctr-versions-menu.conf</span></code> configuration file<a class="headerlink" href="#doctr-versions-menu-conf-configuration-file" title="Permalink to this headline">¶</a></h3>
<p>If you do need to customize <code class="docutils literal notranslate"><span class="pre">doctr-versions-menu</span></code>’s behavior, the recommended
way to do so it to place a configuration file <code class="docutils literal notranslate"><span class="pre">doctr-versions-menu.conf</span></code> in
the root of the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch. This configuration file can contain
definitions matching <code class="docutils literal notranslate"><span class="pre">doctr-versions-menu</span></code>’s <a class="reference internal" href="#command-line-options"><span class="std std-ref">Command line options</span></a>,
formatted according to <a class="reference external" href="https://configobj.readthedocs.io/en/latest/configobj.html#unrepr-mode">Configobj’s unrepr mode</a>.</p>
<p>Every long-form flag has a corresponding config file variable, obtained by
replacing hyphens with underscores. For boolean flags, the variable name is
derived from the <em>first</em> flag option.</p>
<p>For example, the settings</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">downloads_file</span> <span class="o">=</span> <span class="s2">&quot;.downloads&quot;</span>
<span class="n">ensure_no_jekyll</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<p>correspond to <code class="docutils literal notranslate"><span class="pre">--downloads-file=.downloads</span></code> and <code class="docutils literal notranslate"><span class="pre">--ignore-no-jekyll</span></code>.</p>
<p>See also the Doctr Versions Menu’s own <a class="reference external" href="https://github.com/goerz/doctr_versions_menu/blob/gh-pages/doctr-versions-menu.conf">doctr-versions-menu.conf file</a>, which
illustrates some advanced usage.</p>
</div>
<div class="section" id="command-line-options">
<span id="id2"></span><h3>Command line options<a class="headerlink" href="#command-line-options" title="Permalink to this headline">¶</a></h3>
<div class="section" id="doctr-versions-menu">
<h4>doctr-versions-menu<a class="headerlink" href="#doctr-versions-menu" title="Permalink to this headline">¶</a></h4>
<p>Generate versions json file in OUTFILE.</p>
<p>This should be run from the root of a <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch of a project
using the Doctr Versions Menu.</p>
<p>Except for debugging, it is recommended to set options through the config
file (<code class="docutils literal notranslate"><span class="pre">doctr-versions-menu.conf</span></code> in the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> root)
instead of via command line flags. Every long-form-flag has a corresponding
config file variable, obtained by replacing hyphens with underscores
(<code class="docutils literal notranslate"><span class="pre">--write-index-html</span></code> → <code class="docutils literal notranslate"><span class="pre">write_index_html</span></code>).</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>doctr-versions-menu <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-doctr-versions-menu-version">
<code class="sig-name descname">--version</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-doctr-versions-menu-version" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the version and exit.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-doctr-versions-menu-debug">
<code class="sig-name descname">--debug</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-doctr-versions-menu-debug" title="Permalink to this definition">¶</a></dt>
<dd><p>enable debug logging</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-doctr-versions-menu-o">
<code class="sig-name descname">-o</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--outfile</code><code class="sig-prename descclassname"> &lt;outfile&gt;</code><a class="headerlink" href="#cmdoption-doctr-versions-menu-o" title="Permalink to this definition">¶</a></dt>
<dd><p>File to which to write json data  [default: versions.json]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-doctr-versions-menu-versions">
<code class="sig-name descname">--versions</code><code class="sig-prename descclassname"> &lt;versions&gt;</code><a class="headerlink" href="#cmdoption-doctr-versions-menu-versions" title="Permalink to this definition">¶</a></dt>
<dd><p>Specification of versions to be included in the menu, from oldest/lowest priority to newest/highest priority. The newest/highest priority items will be shown first. See the online documentation for the SPEC syntax.  [default: (&lt;branches&gt; != master), &lt;releases&gt;, master]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-doctr-versions-menu-latest">
<code class="sig-name descname">--latest</code><code class="sig-prename descclassname"> &lt;latest&gt;</code><a class="headerlink" href="#cmdoption-doctr-versions-menu-latest" title="Permalink to this definition">¶</a></dt>
<dd><p>Specification of which version is considered the “latest public release”. If it exists, the main index.html should forward to this version, and warnings e.g. for “outdated” versions should link to it. See the online documentation for the SPEC syntax.  [default: (&lt;public-releases&gt;)[-1]]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-doctr-versions-menu-warning">
<code class="sig-name descname">--warning</code><code class="sig-prename descclassname"> &lt;warning&gt;</code><a class="headerlink" href="#cmdoption-doctr-versions-menu-warning" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a warning. The NAME is a lowercase label that will appear in the warnings data in versions.json and maybe be picked up by the javascript rendering warning in the HTML output. The SPEC is a folder specification for all folders that should show the warning. See the online documentation for the syntax of SPEC. The SPEC should give given as a quoted string. This option may be given multiple times.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-doctr-versions-menu-label">
<code class="sig-name descname">--label</code><code class="sig-prename descclassname"> &lt;label&gt;</code><a class="headerlink" href="#cmdoption-doctr-versions-menu-label" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a template for labels in the versions menu. The LABELTEMPLATE applies to all folders matching the given SPEC. See the online documentation for the syntax of SPEC. The LABELTEMPLATE is rendered with Jinja, receiving the ‘folder’ name. See the online documentation for details. This option may be given multiple times.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-doctr-versions-menu-write-index-html">
<code class="sig-name descname">--write-index-html</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--no-write-index-html</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-doctr-versions-menu-write-index-html" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to write an index.html that forwards to the latest publi release. In the config file, override this as <code class="docutils literal notranslate"><span class="pre">write_index_html=False</span></code>.  [default: True]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-doctr-versions-menu-write-versions-py">
<code class="sig-name descname">--write-versions-py</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--no-write-versions-py</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-doctr-versions-menu-write-versions-py" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to write a script versions.py to the root of the gh-pages branch for regenerating versions.json. This is useful for maintenance on the gh-pages branch, e.g., removing outdated version.  [default: True]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-doctr-versions-menu-ensure-no-jekyll">
<code class="sig-name descname">--ensure-no-jekyll</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--ignore-no-jekyll</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-doctr-versions-menu-ensure-no-jekyll" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to check that a .nojekyll file exist and create it otherwise. In the config file, override this as <code class="docutils literal notranslate"><span class="pre">ensure_no_jekyll=False</span></code>.  [default: True]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-doctr-versions-menu-downloads-file">
<code class="sig-name descname">--downloads-file</code><code class="sig-prename descclassname"> &lt;downloads_file&gt;</code><a class="headerlink" href="#cmdoption-doctr-versions-menu-downloads-file" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the file inside of each folder from which to read the download links. Each line in the file must be of the form “[label]: url”.  [default: _downloads]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-doctr-versions-menu-suffix-latest">
<code class="sig-name descname">--suffix-latest</code><code class="sig-prename descclassname"> &lt;suffix_latest&gt;</code><a class="headerlink" href="#cmdoption-doctr-versions-menu-suffix-latest" title="Permalink to this definition">¶</a></dt>
<dd><p>Suffix for the label of the latest public release. This is used in addition to any label set via the –label option  [default:  (latest)]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-doctr-versions-menu-c">
<code class="sig-name descname">-c</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--config</code><code class="sig-prename descclassname"> &lt;config&gt;</code><a class="headerlink" href="#cmdoption-doctr-versions-menu-c" title="Permalink to this definition">¶</a></dt>
<dd><p>Read configuration from FILE. Each line in FILE should be of the form “variable = value” in Python syntax, with variable names corresponding to any long-form command line flag, e.g. <code class="docutils literal notranslate"><span class="pre">ensure_no_jekyll</span> <span class="pre">=</span> <span class="pre">False</span></code>.  [default: doctr-versions-menu.conf]</p>
</dd></dl>

</div>
</div>
<div class="section" id="folders-included-in-the-menu">
<h3>Folders included in the menu<a class="headerlink" href="#folders-included-in-the-menu" title="Permalink to this headline">¶</a></h3>
<p>By default, the version menu lists the <code class="docutils literal notranslate"><span class="pre">master</span></code> branch first, then any
releases from newest to oldest, and then any non-release branches in
reverse-alphabetical order. Having the “newest” releases appear first matches the
behavior of Read-the-Docs.</p>
<p>The folders that are listed in the versions menu and their order can be
customized via the <a class="reference internal" href="#cmdoption-doctr-versions-menu-versions"><code class="xref std std-option docutils literal notranslate"><span class="pre">--versions</span></code></a> flag (<code class="docutils literal notranslate"><span class="pre">versions</span></code> in the config file).
This receives a <a class="reference internal" href="folderspecs.html#folderspecs"><span class="std std-ref">folder specification</span></a> as an argument that
specifies the folders to appear in the menu in reverse order (bottom/right to
top/left).</p>
<p>To un-reverse the default order of folders in the menu, so that the newest
versions appear last, you could use the following specification in the config
file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">versions</span> <span class="o">=</span> <span class="s1">&#39;((&lt;branches&gt; != master), &lt;releases&gt;, master)[::-1]&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="labels-in-the-versions-menu">
<h3>Labels in the versions menu<a class="headerlink" href="#labels-in-the-versions-menu" title="Permalink to this headline">¶</a></h3>
<p>By default, the label for each folder that appears in the menu is simply the
name of the folder. The “latest public release”, identified by
<a class="reference internal" href="#cmdoption-doctr-versions-menu-latest"><code class="xref std std-option docutils literal notranslate"><span class="pre">--latest</span></code></a> (the latest public release by default), has
” (latest)” appended. This can be customized with the
<a class="reference internal" href="#cmdoption-doctr-versions-menu-suffix-latest"><code class="xref std std-option docutils literal notranslate"><span class="pre">--suffix-latest</span></code></a>.</p>
<p>More generally, the <a class="reference internal" href="#cmdoption-doctr-versions-menu-label"><code class="xref std std-option docutils literal notranslate"><span class="pre">--label</span></code></a> option may be used to define label
templates for specific groups of folders. The <a class="reference internal" href="#cmdoption-doctr-versions-menu-label"><code class="xref std std-option docutils literal notranslate"><span class="pre">--label</span></code></a> receives two
arguments, a <a class="reference internal" href="folderspecs.html#folderspecs"><span class="std std-ref">folder specification</span></a> for the folders to which
the template should apply, and a Jinja-template-string that should receive the
variable “folder” for rendering. For example,</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>doctr-versions-menu --label <span class="s1">&#39;&lt;releases&gt;&#39;</span>  <span class="s2">&quot;{{ folder | replace(&#39;v&#39;, &#39;&#39;, 1) }}&quot;</span> --label master <span class="s1">&#39;{{ folder }} (latest dev branch)&#39;</span>
</pre></div>
</div>
<p>drops the initial “v” from the folder name of released versions (<code class="docutils literal notranslate"><span class="pre">v1.0.0</span></code> →
<code class="docutils literal notranslate"><span class="pre">1.0.0</span></code>) and appends a label ” (latest dev branch)” to the label for the
<code class="docutils literal notranslate"><span class="pre">master</span></code> folder.</p>
<p>In the config file (the recommended way to set custom labels), the above options would be specified as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;[</span>
<span class="s1">    (&#39;&lt;releases&gt;&#39;, &quot;{{ folder | replace(&#39;v&#39;, &#39;&#39;, 1) }}&quot;),</span>
<span class="s1">    (&#39;master&#39;, &#39;{{ folder }} (latest dev branch)&#39;)</span>
<span class="s1">]&#39;&#39;&#39;</span>
</pre></div>
</div>
<p>The triple-quotes are required for a multi-line entry.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Read-the-Docs uses “latest” to refer to the latest development
version (usually <code class="docutils literal notranslate"><span class="pre">master</span></code>) instead of the latest public release, and
instead labels the latest public release as “stable”. You may adopt
Read-the-Docs nomeclature with e.g.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>--suffix-latest<span class="o">=</span><span class="s2">&quot; (stable)&quot;</span> --label master <span class="s1">&#39;master (latest)&#39;</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>--suffix-latest<span class="o">=</span><span class="s2">&quot; (stable)&quot;</span> --label master latest
</pre></div>
</div>
</div>
</div>
<div class="section" id="custom-warning-messages">
<h3>Custom warning messages<a class="headerlink" href="#custom-warning-messages" title="Permalink to this headline">¶</a></h3>
<p>By default, the Doctr Versions Menu plugin injects warnings in the rendered
HTML files, within the following types of folders:</p>
<ul class="simple">
<li><p>an ‘outdated’ warning for <code class="docutils literal notranslate"><span class="pre">&lt;releases&gt;</span></code> older than the latest public release (<a class="reference internal" href="#cmdoption-doctr-versions-menu-latest"><code class="xref std std-option docutils literal notranslate"><span class="pre">--latest</span></code></a>)</p></li>
<li><p>an ‘unreleased’ warning for <code class="docutils literal notranslate"><span class="pre">&lt;branches&gt;</span></code> (anything that is not a <span class="target" id="index-1"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0440"><strong>PEP 440</strong></a>-conforming release) or <code class="docutils literal notranslate"><span class="pre">&lt;local-releases&gt;</span></code> (typically not used)</p></li>
<li><p>a ‘prereleased’ warning for anything considered a pre-release by <span class="target" id="index-2"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0440"><strong>PEP 440</strong></a>, e.g. <code class="docutils literal notranslate"><span class="pre">v1.0.0-rc1</span></code></p></li>
</ul>
<p>Which folders are included in the above three categories can be modified via the <a class="reference internal" href="#cmdoption-doctr-versions-menu-warning"><code class="xref std std-option docutils literal notranslate"><span class="pre">--warning</span></code></a> option.
This options receives two arguments, a “warning label” string (the above
‘outdated’, ‘unreleased’, or ‘prereleased’), and a
<a class="reference internal" href="folderspecs.html#folderspecs"><span class="std std-ref">folder specification</span></a> for the
folders to which the warning should apply. An empty specification would disable
the warning, e.g.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>doctr-versions-menu --warning prereleased <span class="s1">&#39;&#39;</span>
</pre></div>
</div>
<p>to disable the warning message on pre-releases.</p>
<p>It is also possible to define entirely new warning labels using <a class="reference internal" href="#cmdoption-doctr-versions-menu-warning"><code class="xref std std-option docutils literal notranslate"><span class="pre">--warning</span></code></a>. For example,</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>doctr-versions-menu --warning post <span class="s1">&#39;&lt;post-releases&gt;&#39;</span>
</pre></div>
</div>
<p>would define a warning ‘post’ for all post-releases.</p>
<p>The information about which folders should display which warnings is stored
internally in the resulting <code class="docutils literal notranslate"><span class="pre">versions.json</span></code> file, in a dict ‘warnings’ the
maps folder names to a list of warning labels.</p>
<p>To actually show the warning, the <code class="docutils literal notranslate"><span class="pre">doctr-versions-menu.js_t</span></code> template would
have to be modified to pick up on the ‘post’ label, see the instructions for
the <a class="reference internal" href="sphinx_extension.html#sphinx-ext-customization"><span class="std std-ref">Customization</span></a> of the <code class="docutils literal notranslate"><span class="pre">doctr_versions_menu</span></code> Sphinx
extension.</p>
<p>In the config file, the above options may be configured as e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">warning</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;[</span>
<span class="s1">    (&#39;post&#39;, &#39;&lt;post-releases&gt;&#39;),</span>
<span class="s1">    (&#39;prereleased&#39;, &#39;&#39;),</span>
<span class="s1">]&#39;&#39;&#39;</span>
</pre></div>
</div>
<p>The default settings (with the default <code class="docutils literal notranslate"><span class="pre">--latest</span></code>) correspond to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">warning</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;[</span>
<span class="s1">    (&#39;outdated&#39;, &#39;(&lt;releases&gt; &lt; (&lt;public-releases&gt;)[-1])&#39;),</span>
<span class="s1">    (&#39;unreleased&#39;,  &#39;&lt;branches&gt;, &lt;local-releases&gt;&#39;),</span>
<span class="s1">    (&#39;prereleased&#39;, &#39;&lt;pre-releases&gt;&#39;),</span>
<span class="s1">]&#39;&#39;&#39;</span>
</pre></div>
</div>
<p>Note the triple-quotes required for a multi-line entry.</p>
</div>
<div class="section" id="customizing-index-html">
<span id="id3"></span><h3>Customizing <code class="docutils literal notranslate"><span class="pre">index.html</span></code><a class="headerlink" href="#customizing-index-html" title="Permalink to this headline">¶</a></h3>
<p>By default, <code class="docutils literal notranslate"><span class="pre">doctr-versions-menu</span></code> generates an <code class="docutils literal notranslate"><span class="pre">index.html</span></code> file in the
root of the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch that redirects to the current “default folder”.
This is the folder for the most current public release (<a class="reference internal" href="#cmdoption-doctr-versions-menu-latest"><code class="xref std std-option docutils literal notranslate"><span class="pre">--latest</span></code></a>), or
<code class="docutils literal notranslate"><span class="pre">master</span></code> if no public release exists.</p>
<p>The generated <code class="docutils literal notranslate"><span class="pre">index.html</span></code> file can be customized by placing an
<code class="docutils literal notranslate"><span class="pre">index.html_t</span></code> <a class="reference external" href="https://jinja.palletsprojects.com/en/2.10.x/">Jinja</a> template into the root of the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch.
This template will be rendered receiving a dict <code class="docutils literal notranslate"><span class="pre">version_data</span></code> containing the
data in <code class="docutils literal notranslate"><span class="pre">versions.json</span></code> (see the <a class="reference internal" href="versions_json.html#versions-json-structure"><span class="std std-ref">versions.json Structure</span></a>).</p>
<p>The default template is</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;Refresh&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;0; url={{ version_data[&#39;latest&#39;] | default(&#39;master&#39;, true) }}&quot;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Go to the <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ version_data[&#39;latest&#39;] | default(&#39;master&#39;, true) }}&quot;</span><span class="p">&gt;</span>default documentation<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Alternatively, if you want a completely static <code class="docutils literal notranslate"><span class="pre">index.html</span></code>, you could also
just add that file by hand and use <a class="reference internal" href="#cmdoption-doctr-versions-menu-write-index-html"><code class="xref std std-option docutils literal notranslate"><span class="pre">--no-write-index-html</span></code></a>
(that is, <code class="docutils literal notranslate"><span class="pre">write_index_html=False</span></code> in the <a class="reference internal" href="#doctr-versions-menu-conf"><span class="std std-ref">doctr-versions-menu.conf configuration file</span></a>).</p>
</div>
</div>
<div class="section" id="maintenance-on-gh-pages">
<h2>Maintenance on <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code><a class="headerlink" href="#maintenance-on-gh-pages" title="Permalink to this headline">¶</a></h2>
<p>Unless <a class="reference internal" href="#cmdoption-doctr-versions-menu-write-index-html"><code class="xref std std-option docutils literal notranslate"><span class="pre">--no-write-index-html</span></code></a> is given, running
<code class="docutils literal notranslate"><span class="pre">doctr-versions-menu</span></code> will generate a script <code class="docutils literal notranslate"><span class="pre">versions.py</span></code> in the root of
the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch that may be used to regenerate the <code class="docutils literal notranslate"><span class="pre">versions.json</span></code>
file. This script is intended for manual maintenance on the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code>
branch, that is, outside of the normal automatic Doctr-deployment through
Travis. For example, you may occasionally want to remove folders for outdated
branches or pre-releases from the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch, or update existing
download links.</p>
<p>After any such change, run the <code class="docutils literal notranslate"><span class="pre">versions.py</span></code> script before committing and
pushing the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch.</p>
<p>Remember that each folder on the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch generally contains its own
<code class="docutils literal notranslate"><span class="pre">doctr-versions-menu.js</span></code> script. Switching a project to a new major version
of <code class="docutils literal notranslate"><span class="pre">doctr-versions-menu</span></code>, if that version changes the internal data structure of
<code class="docutils literal notranslate"><span class="pre">versions.json</span></code>, may require updating the <code class="docutils literal notranslate"><span class="pre">doctr-versions-menu.js</span></code> script
in existing folders by hand.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="folderspecs.html" class="btn btn-neutral float-right" title="Folder Specifications" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sphinx_extension.html" class="btn btn-neutral float-left" title="Step 1: Sphinx extension" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Michael Goerz
      <span class="lastupdated">
        Last updated on Mar 14, 2020.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>